{{ define "main" }}
<section id="blog-single" class="blog blog-single section section--border-bottom rad-animation-group flex-grow-1">
  <article id="main-content" tabindex="-1" class="blog-post" aria-labelledby="blog-post-title">
    <header class="post-header">
      <h1 id="blog-post-title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h1>

      <div id="meta" class="light-border-bottom">
        <div class="post-meta">
          <div class="post-meta-info">
            <span class="published-label">{{ i18n "published_on" }}</span>
            <time id="date" class="date" datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Mon Jan 2, 2006" }}</time>
            <span class="meta-separator" aria-hidden="true">·</span>
            <span id="wordcount" class="wordcount">{{ .WordCount }} Words</span>
            {{ $readingTime := div .WordCount 200 }}
            {{ if lt $readingTime 1 }}
              {{ $readingTime = 1 }}
            {{ end }}
            <span class="meta-separator" aria-hidden="true">·</span>
            <span id="reading-time" class="reading-time">{{ $readingTime }} {{ i18n "min_read" | default "min read" }}</span>
            {{ if .Params.lastmod }}
              <span class="meta-separator" aria-hidden="true">·</span>
              <span id="last-modified" class="last-modified">{{ i18n "last_updated" | default "Updated" }}: {{ .Lastmod.Format "Jan 2, 2006" }}</span>
            {{ end }}
          </div>
          {{ $authorTerms := .GetTerms "authors" }}
          {{ if $authorTerms }}
          <div class="post-authors-inline">
            <span class="post-authors-label">{{ i18n "authors" | default "Authors" }}:</span>
            {{ range $index, $author := $authorTerms }}
              {{ if gt $index 0 }}, {{ end }}<a href="{{ $author.RelPermalink }}"><strong>{{ $author.LinkTitle }}</strong></a>
            {{ end }}
          </div>
          {{ else }}
          {{ $authorNames := slice }}
          {{ with .Params.author }}
            {{ if reflect.IsString . }}
              {{ $authorNames = $authorNames | append . }}
            {{ end }}
          {{ end }}
          {{ with .Params.authors }}
            {{ if reflect.IsSlice . }}
              {{ range . }}
                {{ if . }}{{ $authorNames = $authorNames | append . }}{{ end }}
              {{ end }}
            {{ else if reflect.IsString . }}
              {{ $authorNames = $authorNames | append . }}
            {{ end }}
          {{ end }}
          {{ if gt (len $authorNames) 0 }}
          <div class="post-authors-inline">
            <span class="post-authors-label">{{ i18n "authors" | default "Authors" }}:</span>
            {{ range $index, $authorName := $authorNames }}
              {{- if gt $index 0 }}, {{ end -}}
              {{- $authorSlug := $authorName | urlize -}}
              {{- with $.Site.GetPage "taxonomy" "authors" $authorSlug -}}
                <a href="{{ .RelPermalink }}"><strong>{{ $authorName }}</strong></a>
              {{- else -}}
                <strong>{{ $authorName }}</strong>
              {{- end -}}
            {{ end }}
          </div>
          {{ end }}
          {{ end }}
          {{ with .GetTerms "topics" }}
          <ul id="topics">
            {{ range . }}
            <li><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></li>
            {{ end }}
          </ul>
          {{ end }} {{ with .GetTerms "tags" }}
          <ul class="tags">
            {{ range . }}
            <li><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></li>
            {{ end }}
          </ul>
          {{ end }}
        </div>
      </div>
    </header>

    {{ partial "toc.html" . }}

    <div class="row flex-column-reverse flex-md-row rad-fade-down">
      <div class="col-12 post-content">{{ .Content | safeHTML }}</div>
    </div>

    {{ partial "social-sharing.html" . }}

    {{ partial "related-posts.html" . }}

    <aside class="content-browser light-border-top">
      {{ i18n "continue_reading" }}
      <div>
        {{ with .PrevInSection }}
        <a class="previous" href="{{ .RelPermalink }}">↩ {{ .LinkTitle }}</a>
        {{ end }}
        ■
        {{ with .NextInSection }}
        <a class="next" href="{{ .RelPermalink }}"> {{ .LinkTitle }} ↪</a>
        {{ end }}
      </div>
    </aside>

    {{ partial "comments.html" . }}
  </article>
</section>
{{ end }}
